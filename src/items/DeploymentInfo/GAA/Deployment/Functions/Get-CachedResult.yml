---
ID: "04adc097-b435-47e4-bb23-6e8f3950568c"
Parent: "fd09a050-8da4-492c-9131-a44621d32836"
Template: "dd22f1b3-bd87-4db2-9e7d-f7a496888d43"
Path: "/sitecore/system/Modules/PowerShell/Script Library/GAA/Deployment/Functions/Get-CachedResult"
SharedFields:
- ID: "b1a94ff0-6897-47c0-9c51-aa6acb80b1f0"
  Hint: Script
  Value: |
    # Store the script result in the cache with the specified expiry duration
    Function Get-CachedResult {
        [cmdletbinding()]
        Param(
            [Parameter(Mandatory = $true)]
            $Key,
            [ScriptBlock]
            $ScriptBlock,
            [switch] $Reset,
            $cachExpSeconds = 1230
        )
        $CACHE_VARIABLE_NAME = "PS_Scripting_Cache"
        $cacheSize = [Sitecore.StringUtil]::ParseSizeString("200KB")
        $cache = [Sitecore.Caching.CacheManager]::GetNamedInstance($CACHE_VARIABLE_NAME, $cacheSize, $true)
    
        $cachedValue = $cache.GetEntry($Key).Data
        
        if ($cachedValue -and (-not $Reset)) {
            return $cachedValue
        }
        try {
            if(-not $ScriptBlock){
                return $null
            }
    
            $cachedValue = &$ScriptBlock
            if ($null -ne $cachedValue) {
                $date = Get-Date
                $exp = $date.AddSeconds($cachExpSeconds)
                Write-Log "[Deployment-Get-CachedResult] Adding $Key with exp: $cachExpSeconds"
                $cache.Add($Key, $cachedValue, $exp) | Out-Null 
            }
        }
        catch {
            Write-Log "[Deployment-Get-CachedResult] Executing script failed. $($_)" -Log Error
        } 
    
        $cachedValue
    }
Languages:
- Language: en
  Versions:
  - Version: 1
    Fields:
    - ID: "25bed78c-4957-4165-998a-ca1b52f67497"
      Hint: __Created
      Value: 20231112T172415Z
    - ID: "52807595-0f8f-4b20-8d2a-cb71d28c6103"
      Hint: __Owner
      Value: |
        sitecore\ghodrat.ashournia@unic.com
    - ID: "5dd74568-4d4b-44c1-b513-0af5f4cda34f"
      Hint: __Created by
      Value: |
        sitecore\ghodrat.ashournia@unic.com
    - ID: "8cdc337e-a112-42fb-bbb4-4143751e123f"
      Hint: __Revision
      Value: "bdc03f19-6eec-4bca-bd0e-9b309128615c"
    - ID: "badd9cf9-53e0-4d0c-bcc0-2d784c282f6a"
      Hint: __Updated by
      Value: |
        sitecore\ghodrat.ashournia@unic.com
    - ID: "d9cf14b1-fa16-4ba6-9288-e8a174d4d522"
      Hint: __Updated
      Value: 20231118T121539Z
